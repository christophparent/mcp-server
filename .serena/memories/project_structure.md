# Project Structure - Agentset MCP

```
agentset-mcp/
├── src/
│   ├── index.ts                # Main MCP server entry point (#!/usr/bin/env node)
│   └── utils.ts                # Helper functions (getVersion, parseOptions)
│
├── dist/                       # Built output (TypeScript declarations + JS)
│   ├── index.js                # Compiled main entry
│   ├── index.d.ts              # Type declarations
│   ├── utils.js
│   └── utils.d.ts
│
├── build/                      # Alternative build output directory
│
├── test/                       # Test files (.mjs format)
│
├── scripts/                    # Helper scripts
│   ├── start-mcp-emco-products.sh  # Launch with EMCO namespace
│   └── start-mcp-ahri.sh           # Launch with AHRI namespace
│
├── .changeset/                 # Changesets for version management
│
├── .github/                    # GitHub workflows and config
│
├── .vscode/                    # VSCode settings
│
├── .claude/                    # Claude Code configuration
│
├── .serena/                    # Serena MCP memory files
│   └── memories/               # Project onboarding documentation
│
├── package.json                # Package configuration with bin entries
├── tsconfig.json               # TypeScript configuration
├── tsup.config.ts              # tsup bundler configuration (if exists)
├── eslint.config.js            # ESLint 9.x flat config
├── .prettierrc                 # Prettier configuration
├── .nvmrc                      # Node 20.18.0
├── .npmrc                      # pnpm configuration
├── .gitignore                  # Git ignore rules
│
├── .env.local                  # Local environment (gitignored)
├── .env.local.example          # Environment template
├── .env.ahri                   # AHRI namespace config
│
├── README.md                   # Main documentation
├── CHANGELOG.md                # Version history (changesets)
├── LICENSE                     # MIT License
│
├── NAMESPACE_SETUP.md          # Namespace configuration guide
├── NAMESPACES_OVERVIEW.md      # Overview of available namespaces
├── README_NAMESPACES.md        # Namespace-specific README
├── AHRI_NAMESPACE_USAGE.md     # AHRI namespace documentation
├── FINAL_CONFIGURATION.md      # Setup completion guide
├── SETUP_SUMMARY.md            # Quick setup summary
│
├── claude-desktop-config.example.json  # Claude Desktop config template
│
└── eslint-types.d.ts           # TypeScript types for ESLint config
```

## Key Files & Their Purposes

### Core Application
- **src/index.ts** - Main MCP server with Agentset integration
  - Parses CLI arguments with commander
  - Initializes Agentset client
  - Registers `knowledge-base-retrieve` tool
  - Connects to stdio transport

- **src/utils.ts** - Utility functions
  - `getVersion()` - Read version from package.json
  - `parseOptions()` - Parse and validate CLI arguments + env vars

### Build Output
- **dist/** - TypeScript transpiled to JavaScript
  - .js files for execution
  - .d.ts files for type information
  - .d.ts.map files for declaration sourcemaps

### Configuration
- **package.json** - Dependencies, scripts, bin entries
  - bin: agentset-mcp and agentset-mcp-server executables
  - main: ./dist/index.js
  - files: Includes dist/, package.json, CHANGELOG.md for npm

- **tsconfig.json** - TypeScript compiler options
  - Strict mode enabled
  - ES2022 target
  - Bundler module resolution
  - Declaration generation for dist/

- **.env.local.example** - Environment variable template
  - AGENTSET_API_KEY
  - AGENTSET_NAMESPACE_ID (optional, can use --ns flag)

### Scripts
- **scripts/start-mcp-emco-products.sh** - Launch with EMCO product namespace
- **scripts/start-mcp-ahri.sh** - Launch with AHRI certification namespace

### Documentation
- **README.md** - Installation, usage, multiple namespace setup
- **CHANGELOG.md** - Auto-generated by changesets
- **NAMESPACE_SETUP.md** - How to configure namespaces
- **NAMESPACES_OVERVIEW.md** - Available namespaces (EMCO, AHRI)
- **AHRI_NAMESPACE_USAGE.md** - AHRI-specific usage guide

## Architecture Overview

### Entry Point Flow
1. **CLI parsing** - commander reads --ns, --tenant, --description, --version
2. **Environment validation** - parseOptions() checks AGENTSET_API_KEY
3. **Agentset initialization** - Create client with API key and custom fetcher
4. **Namespace connection** - Connect to specified namespace
5. **Tool registration** - Register knowledge-base-retrieve tool
6. **Transport connection** - Connect to stdio transport
7. **Server ready** - Log "Agentset MCP Server running on stdio"

### Tool Implementation
- **knowledge-base-retrieve**
  - Input: query (string), topK (1-100, default 10), rerank (boolean, default true)
  - Calls: `ns.search(query, {topK, rerank}, tenantId)`
  - Output: Array of text content items

### Build Process
1. **tsup** - Bundles TypeScript to JavaScript
2. **TypeScript** - Generates declaration files (.d.ts)
3. **Output** - dist/ directory with executable index.js

### Namespace Configuration
This project supports multiple namespaces for different knowledge bases:
- **EMCO products** - Plumbing/HVAC product catalog
- **AHRI certifications** - HVAC equipment certification data

Each namespace can be launched via:
- Environment variable: `AGENTSET_NAMESPACE_ID=ns_xxx`
- CLI flag: `--ns ns_xxx`
- Helper script: `pnpm mcp:emco` or `pnpm mcp:ahri`

## Ignored Files/Directories
- `node_modules/` - Dependencies
- `dist/` - Built output (regenerated)
- `build/` - Alternative build output
- `.env.local` - Local environment with secrets
- `.cache/` - TypeScript build info
- `.turbo/` - Turborepo cache (if using monorepo)
